<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>404 — Creativity Not Found</title>
<meta name="description" content="Drag the crop to find the missing idea. Built for MTC × OhCrop." />
<style>
/* =========================
   THEME & BASE (MTC × OhCrop)
   ========================= */
:root{
  --bg:#070b16; --bg2:#0e1730; --fg:#eaf2ff; --muted:#9fb0c4;
  --accent:#8b5cf6;  /* OhCrop purple */
  --green:#16a34a;   /* MTC green (success) */
  --panel:rgba(255,255,255,.06); --panelbd:rgba(255,255,255,.10);
}
@media (prefers-color-scheme:light){
  :root{
    --bg:#f6f8ff; --bg2:#e9efff; --fg:#0b1220; --muted:#435266;
    --accent:#6d28d9; --green:#22c55e;
    --panel:rgba(0,0,0,.04); --panelbd:rgba(0,0,0,.08);
  }
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; color:var(--fg);
  font:600 16px/1.45 system-ui, Segoe UI, Roboto, Arial, sans-serif;
  background:
    radial-gradient(1400px 900px at 70% -10%, rgba(139,92,246,.20), transparent 60%),
    linear-gradient(180deg, var(--bg2), var(--bg));
  overflow-x:hidden;
}

/* subtle film grain */
body::before{
  content:""; position:fixed; inset:0; pointer-events:none;
  background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="120" height="120"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="2" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23n)" opacity="0.06"/></svg>');
  background-size:120px 120px; mix-blend-mode:overlay;
}

.wrap{max-width:1100px;margin:0 auto;padding:28px}
header{text-align:center;margin-bottom:12px}
h1{
  margin:.1rem 0 .25rem;
  font-size:clamp(2.2rem,6.8vw,3.8rem);
  letter-spacing:.3px;
  text-shadow:0 2px 10px rgba(0,0,0,.35);
}
.lead{color:var(--muted);margin:0 0 14px;font-weight:600}

.panel{
  margin:18px auto 12px; width:min(980px,96vw);
  border-radius:22px; padding:18px;
  background:linear-gradient(180deg,var(--panel),transparent);
  border:1px solid var(--panelbd);
  box-shadow:inset 0 1px 0 rgba(255,255,255,.06), 0 18px 38px rgba(0,0,0,.28);
}

/* =========================
   STAGE & “PHOTO”
   ========================= */
.stage{
  position:relative; margin:auto; width:min(880px,92vw); aspect-ratio:16/9; border-radius:18px; overflow:hidden;
  background:
    radial-gradient(800px 500px at 0% 0%, rgba(139,92,246,.25), transparent 60%),
    linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
  border:1px solid var(--panelbd);
}
.scene{
  position:absolute; inset:0; filter:blur(8px) saturate(1.2) brightness(0.92); transform:scale(1.05);
  background:
    radial-gradient(600px 420px at 18% 22%, rgba(16,185,129,.95) 0 26%, transparent 27%),
    radial-gradient(520px 380px at 78% 32%, rgba(99,102,241,.95) 0 22%, transparent 23%),
    radial-gradient(760px 520px at 64% 78%, rgba(59,130,246,.95) 0 26%, transparent 27%),
    conic-gradient(from 120deg at 50% 50%, #0b1220, #0f172a, #0b1220);
  transition:filter .5s ease, transform .5s ease;
}
.stage.solved .scene{ filter:blur(0) saturate(1.05) brightness(1); transform:scale(1) }

/* =========================
   CROP TOOL
   ========================= */
.crop{
  --w:44%; --h:38%;
  position:absolute; left:28%; top:30%; width:var(--w); height:var(--h);
  border:2px solid var(--accent); border-radius:12px;
  box-shadow:0 0 0 9999px rgba(0,0,0,.25) inset, 0 10px 28px rgba(0,0,0,.25);
  display:grid; grid-template-columns:1fr 1fr 1fr; grid-template-rows:1fr 1fr 1fr; cursor:move;
  transition:box-shadow .15s ease, border-color .15s ease;
  animation:floaty 3s ease-in-out 2;
}
@keyframes floaty { 0%{transform:translateY(0)} 50%{transform:translateY(-4px)} 100%{transform:translateY(0)} }
.crop:focus-visible{ outline:4px solid #fff; outline-offset:3px }
.stage.solved .crop{ pointer-events:none; border-color:var(--green); box-shadow:0 0 0 9999px rgba(0,0,0,.05) inset, 0 12px 30px rgba(34,197,94,.35) }

/* thirds grid */
.crop .g{border:1px dashed rgba(255,255,255,.18)}
.crop .g:nth-child(2), .crop .g:nth-child(3){border-left:none}
.crop .g:nth-child(4), .crop .g:nth-child(7){border-top:none}

/* handles */
.handle{
  position:absolute; width:22px; height:22px; background:var(--accent); border-radius:50%;
  border:2px solid rgba(255,255,255,.9); box-shadow:0 2px 10px rgba(0,0,0,.35), 0 0 0 0 rgba(139,92,246,0); cursor:grab;
}
.handle:active{ cursor:grabbing }
.h-nw{left:-12px; top:-12px} .h-ne{right:-12px; top:-12px}
.h-sw{left:-12px; bottom:-12px} .h-se{right:-12px; bottom:-12px}
@keyframes ping{ to{ box-shadow:0 0 0 10px rgba(139,92,246,0); } }
.handle.h-se{ animation:ping 1.6s ease-out 4 }

/* goal hotspot */
.hotspot{
  position:absolute; left:58%; top:54%; width:80px; height:60px; border-radius:14px;
  outline:2px dashed rgba(255,255,255,.15); outline-offset:-6px; pointer-events:none;
}

/* progress ring */
.progress{
  position:absolute; right:12px; top:12px; width:44px; height:44px; border-radius:50%;
  background:conic-gradient(var(--green) 0deg, rgba(255,255,255,.2) 0deg 360deg);
  display:grid; place-items:center; font:900 12px/1 system-ui; color:#0b1220;
  border:2px solid rgba(255,255,255,.85);
}

/* =========================
   CTAS & FOOTER
   ========================= */
.buttons{ display:flex; justify-content:center; gap:12px; margin:18px 0 6px; flex-wrap:wrap }
.btn{
  appearance:none; border:0; border-radius:999px; padding:12px 18px; cursor:pointer;
  background:#111827; color:#e5e7eb; font-weight:800; letter-spacing:.2px; box-shadow:0 6px 16px rgba(0,0,0,.18)
}
.btn.alt{ background:transparent; color:var(--fg); border:1.5px solid rgba(255,255,255,.22) }
.hint{ text-align:center; color:var(--muted); font-weight:600; margin:8px 0 2px }
.hidden{display:none!important}
footer{ text-align:center; margin-top:10px; color:var(--muted); font-weight:600 }
a{ color:var(--accent); text-decoration:none }

/* confetti */
.confetti{ position:fixed; inset:0; pointer-events:none; overflow:hidden }
.confetti i{ position:absolute; font-style:normal; animation:fall 900ms ease-out forwards; filter:drop-shadow(0 2px 2px rgba(0,0,0,.35)) }
@keyframes fall{ to{ transform:translate(var(--tx), 90vh) rotate(var(--rot)); opacity:0 } }

/* screen-reader only */
.visually-hidden{position:absolute!important;clip:rect(1px,1px,1px,1px)!important;padding:0!important;border:0!important;height:1px!important;width:1px!important;overflow:hidden!important}
</style>
</head>
<body>
  <div class="wrap" role="main">
    <header>
      <h1>404 — Creativity Not Found</h1>
      <p class="lead">Drag the crop to where the idea is hiding. Nail the composition → reveal.</p>
    </header>

    <div class="panel">
      <section class="stage" aria-label="Image stage with a draggable crop tool.">
        <div class="scene" aria-hidden="true"></div>
        <div class="hotspot" aria-hidden="true"></div>

        <div class="crop" id="crop" tabindex="0" role="application" aria-roledescription="crop tool" aria-label="Drag to move. Use arrow keys; hold Shift for fine steps.">
          <div class="g"></div><div class="g"></div><div class="g"></div>
          <div class="g"></div><div class="g"></div><div class="g"></div>
          <div class="g"></div><div class="g"></div><div class="g"></div>
          <div class="handle h-nw" data-corner="nw" aria-hidden="true"></div>
          <div class="handle h-ne" data-corner="ne" aria-hidden="true"></div>
          <div class="handle h-sw" data-corner="sw" aria-hidden="true"></div>
          <div class="handle h-se" data-corner="se" aria-hidden="true"></div>
          <div class="progress" id="progress">0%</div>
        </div>
        <p id="live" class="visually-hidden" aria-live="polite"></p>
      </section>
    </div>

    <div id="ctas" class="hidden">
      <div class="buttons">
        <a class="btn" href="/">Go Home</a>
        <button id="resetBtn" class="btn alt" type="button">Reset puzzle</button>
        <a class="btn alt" href="https://github.com/issues/new" target="_blank" rel="noopener">Report issue</a>
      </div>
      <p class="hint">Keyboard works too (arrows / Shift+arrows). Easter egg: type <kbd>4</kbd><kbd>0</kbd><kbd>4</kbd> for instant reveal.</p>
    </div>

    <footer>Built for <strong>MTC × OhCrop</strong> — interactive crop puzzle, single file, zero deps. <a href="https://pages.github.com/">GitHub Pages</a></footer>
  </div>

  <div class="confetti" aria-hidden="true"></div>

<script>
(() => {
  const stage = document.querySelector('.stage');
  const crop = document.getElementById('crop');
  const hotspot = document.querySelector('.hotspot');
  const progress = document.getElementById('progress');
  const ctas = document.getElementById('ctas');
  const live = document.getElementById('live');
  const confettiLayer = document.querySelector('.confetti');

  let solved = false, dragging = false, resizing = null;
  let startX=0, startY=0, startRect=null, seq='';

  function rect(el){ return el.getBoundingClientRect(); }
  function clamp(v,min,max){ return Math.max(min, Math.min(max, v)); }

  // Camera shutter micro-sound (WebAudio)
  function shutter() {
    const Ctx = window.AudioContext || window.webkitAudioContext;
    if(!Ctx) return;
    const a = new Ctx();
    const o = a.createOscillator(), g = a.createGain();
    o.type = 'triangle'; o.frequency.setValueAtTime(600, a.currentTime);
    g.gain.setValueAtTime(0.0001, a.currentTime);
    g.gain.exponentialRampToValueAtTime(0.3, a.currentTime + 0.02);
    g.gain.exponentialRampToValueAtTime(0.0001, a.currentTime + 0.20);
    o.connect(g).connect(a.destination); o.start(); o.stop(a.currentTime + 0.22);
  }

  function setCrop(left, top, width, height){
    const srect = rect(stage);
    crop.style.left  = (clamp(left, srect.left, srect.right - width) - srect.left)/srect.width*100 + '%';
    crop.style.top   = (clamp(top,  srect.top,  srect.bottom - height) - srect.top)/srect.height*100 + '%';
    crop.style.width = (clamp(width,  srect.width*0.18, srect.width*0.9))/srect.width*100 + '%';
    crop.style.height= (clamp(height, srect.height*0.18, srect.height*0.9))/srect.height*100 + '%';
    updateProgress();
  }

  function updateProgress(){
    const c = rect(crop), h = rect(hotspot);
    const cx = Math.max(0, Math.min(c.right, h.right) - Math.max(c.left, h.left));
    const cy = Math.max(0, Math.min(c.bottom, h.bottom) - Math.max(c.top, h.top));
    const overlap = (cx*cy) / (h.width*h.height);
    const pct = Math.round(overlap*100);
    progress.style.background = `conic-gradient(var(--green) ${pct*3.6}deg, rgba(255,255,255,.2) 0 360deg)`;
    progress.textContent = pct + '%';
    if(!solved){
      if(pct >= 92){ complete(); }
      else { live.textContent = `Crop alignment ${pct} percent`; }
    }
  }

  function complete(){
    solved = true;
    stage.classList.add('solved');
    ctas.classList.remove('hidden');
    live.textContent = 'Nice! Composition locked. Revealing…';
    shutter();
    popConfetti(innerWidth/2, rect(stage).top + rect(stage).height*0.2);
  }

  // drag & resize
  crop.addEventListener('pointerdown', (e)=>{
    if(solved) return;
    if(e.target.classList.contains('handle')){ resizing = e.target.dataset.corner; }
    else { dragging = true; }
    startX = e.clientX; startY = e.clientY; startRect = rect(crop);
    crop.setPointerCapture(e.pointerId);
  });
  crop.addEventListener('pointermove', (e)=>{
    if(!(dragging||resizing)) return;
    const dx = e.clientX - startX, dy = e.clientY - startY;
    let L = startRect.left, T = startRect.top, W = startRect.width, H = startRect.height;
    if(dragging){ setCrop(L+dx, T+dy, W, H); }
    else{
      if(resizing.includes('n')){ T += dy; H -= dy; }
      if(resizing.includes('s')){ H += dy; }
      if(resizing.includes('w')){ L += dx; W -= dx; }
      if(resizing.includes('e')){ W += dx; }
      const s = rect(stage);
      W = Math.max(W, s.width*0.18); H = Math.max(H, s.height*0.18);
      setCrop(L,T,W,H);
    }
  });
  crop.addEventListener('pointerup', ()=>{ dragging=false; resizing=null; });

  // keyboard move
  crop.addEventListener('keydown', (e)=>{
    if(solved) return;
    const step = e.shiftKey ? 2 : 12;
    if(['ArrowLeft','ArrowRight','ArrowUp','ArrowDown'].includes(e.key)){
      e.preventDefault();
      const r = rect(crop);
      let L=r.left, T=r.top, W=r.width, H=r.height;
      if(e.key==='ArrowLeft')  L -= step;
      if(e.key==='ArrowRight') L += step;
      if(e.key==='ArrowUp')    T -= step;
      if(e.key==='ArrowDown')  T += step;
      setCrop(L,T,W,H);
    }
  });

  // easter egg: typing 404
  window.addEventListener('keydown', (e)=>{
    if(solved) return;
    if(!/\d/.test(e.key)) return;
    seq = (seq + e.key).slice(-3);
    if(seq==='404'){
      const h = rect(hotspot);
      setCrop(h.left, h.top, h.width, h.height);
      complete();
    }
  });

  // reset
  document.getElementById('resetBtn')?.addEventListener('click', () => {
    solved = false; seq = '';
    stage.classList.remove('solved'); ctas.classList.add('hidden');
    const s = stage.getBoundingClientRect();
    setCrop(s.left + s.width*0.28, s.top + s.height*0.30, s.width*0.44, s.height*0.38);
    live.textContent = 'Puzzle reset. Drag the crop to the right spot.';
  });

  // init
  window.addEventListener('load', updateProgress);
  window.addEventListener('resize', updateProgress);

  function popConfetti(x,y){
    const icons = ['✨','⭐','🌟','🎉','💜','💚'];
    for(let i=0;i<80;i++){
      const el = document.createElement('i');
      el.textContent = icons[Math.floor(Math.random()*icons.length)];
      el.style.left = x + 'px';
      el.style.top = y + 'px';
      el.style.setProperty('--tx', (Math.random()*2-1)*360 + 'px');
      el.style.setProperty('--rot', (Math.random()*720-360) + 'deg');
      confettiLayer.appendChild(el);
      setTimeout(()=>el.remove(), 950);
    }
  }
})();
</script>
</body>
</html>
